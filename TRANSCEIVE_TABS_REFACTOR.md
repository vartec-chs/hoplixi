# Обновление экрана LocalSend с разделением на табы

## Описание изменений

В рамках улучшения пользовательского опыта экран `TransceiveScreen` был переработан и разделен на отдельные табы для лучшей организации функционала.

## Структура новых файлов

### Главный экран с табами
- **`transceive_screen_with_tabs.dart`** - Новый главный экран с интегрированными табами
  - Отображает заголовок с информацией о подключении
  - Управляет TabController для переключения между табами
  - Показывает TabBar только при успешном подключении
  - Обрабатывает состояния загрузки и ошибок

### Отдельные табы

#### 1. Чат - `screens/tabs/chat_tab.dart`
- **Назначение**: Обмен текстовыми сообщениями между устройствами
- **Функции**:
  - Отображение истории сообщений в виде пузырьков
  - Поле ввода имени пользователя
  - Поле ввода сообщения с кнопкой отправки
  - Автоматическая прокрутка к новым сообщениям
  - Поддержка системных сообщений
- **Состояния**: Активен только при установленном WebRTC соединении

#### 2. Файлы - `screens/tabs/files_tab.dart`
- **Назначение**: Передача файлов между устройствами
- **Функции**:
  - Выбор и отправка файлов
  - Отображение прогресса передачи с скоростью
  - Управление передачами (пауза/возобновление/отмена)
  - Принятие/отклонение входящих файлов
  - Статистика передач
- **Компоненты**:
  - Заголовок с кнопкой "Отправить файлы"
  - Статистика активных/завершенных передач
  - Список всех файловых передач с прогресс-барами

#### 3. Настройки - `screens/tabs/settings_tab.dart`
- **Назначение**: Управление подключением и отображение технической информации
- **Функции**:
  - Информация о подключении (устройство, режим, состояние)
  - Управление подключением (отключение/переподключение)
  - Копирование адреса в буфер обмена
  - Техническая информация (расширяемая секция)
- **Разделы**:
  - Информация о подключении
  - Управление подключением
  - Техническая информация (URI, попытки переподключения, время подключения)

## Архитектурные улучшения

### 1. Модульность
- Каждый таб выделен в отдельный файл
- Четкое разделение ответственности между компонентами
- Переиспользуемые компоненты для всех табов

### 2. Состояние и управление
- Единый источник данных через WebRTC провайдер
- Реактивное обновление UI при изменении состояния соединения
- Автоматическая подписка на потоки данных при подключении

### 3. Пользовательский интерфейс
- Материальный дизайн 3 с адаптивными компонентами
- Индикаторы состояния подключения в реальном времени
- Прогресс-бары для отслеживания передач файлов
- Интуитивно понятная навигация между табами

### 4. Обработка ошибок
- Graceful обработка отсутствия подключения
- Информативные сообщения об ошибках
- Возможность переподключения из интерфейса

## Переход на новый экран

В файле `router/routes.dart` обновлен импорт и использование:

```dart
// Было:
import 'package:hoplixi/features/localsend/screens/transceive_screen.dart';
return TransceiveScreen(...);

// Стало:
import 'package:hoplixi/features/localsend/screens/transceive_screen_with_tabs.dart';
return TransceiveScreenWithTabs(...);
```

## Преимущества новой архитектуры

1. **Лучшая организация**: Функции логически разделены по табам
2. **Улучшенный UX**: Пользователю легче найти нужную функцию
3. **Масштабируемость**: Легко добавить новые табы в будущем
4. **Поддерживаемость**: Код разделен на логические модули
5. **Производительность**: Табы загружаются только при активном подключении

## Совместимость

- Полная обратная совместимость с существующими WebRTC провайдерами
- Использует те же модели данных и сервисы
- Сохраняет все существующие функции оригинального экрана

## Файлы для удаления (опционально)

После проверки работоспособности можно удалить:
- `transceive_screen.dart` (оригинальный экран)

## Тестирование

Рекомендуется протестировать:
1. Переключение между табами при активном соединении
2. Отправку сообщений в чате
3. Передачу файлов разных размеров
4. Управление подключением через настройки
5. Поведение при разрыве/восстановлении соединения